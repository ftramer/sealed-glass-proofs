#include "http_parser.h"
using namespace proxygen;

#define MAX_HEADERS 10
#define MAX_ELEMENT_SIZE 500

typedef enum { NONE=0, FIELD, VALUE } header_elem;

struct message {
  enum http_parser_type type;
  int method;
  int status_code;
  char request_path[MAX_ELEMENT_SIZE+1];
  char request_uri[MAX_ELEMENT_SIZE+1];
  char fragment[MAX_ELEMENT_SIZE+1];
  char query_string[MAX_ELEMENT_SIZE+1];
  char body[MAX_ELEMENT_SIZE+1];
  int num_headers;
  header_elem last_header_element;
  char headers [MAX_HEADERS][2][MAX_ELEMENT_SIZE+1];
  int should_keep_alive;

  int message_begin_cb_called;
  int headers_complete_cb_called;
  int message_complete_cb_called;
};

void parser_init (http_parser* parser, http_parser_settings* settings);